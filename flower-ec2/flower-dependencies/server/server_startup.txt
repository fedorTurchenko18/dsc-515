#!/bin/bash

# get the public IP of the instance
$public_ip = $(curl checkip.amazonaws.com)
# install pip and git
sudo yum -y install python-pip
sudo yum install git
# clone repository but fetch only needed directory (saves time)
git clone --depth 1 --filter=blob:none --no-checkout https://github.com/fedorTurchenko18/dsc-515.git
cd ~/dsc-515
git sparse-checkout init --cone
git sparse-checkout set flower-ec2/flower-dependencies/server
git checkout
# move to the directory
cd flower-ec2/flower-dependencies/server
# install the requirements
pip install -r -requirements.txt
# run the server script
python3 server.py --public_ip $public_ip